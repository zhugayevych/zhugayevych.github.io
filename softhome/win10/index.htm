<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../../soft.css">
<title>Windows 10</title>
</head>
<body>
<p><span class="h">
 <a class="h" href="./">F</a>
 <a class="h" href="../../../Sys/Software/win10/">R</a>
 </span>
 &nbsp;<a href="http://windows.microsoft.com/en-US/windows">www</a>
 <var>ver:</var>Home 64bit
 </p>

<h2>Setup</h2>
<ul>
<li>Install Windows 10 offline, skip name/email/phone identification, decline personal info collection</li>
<li>Turn off Device encryption (Security group)</li>
<li>Deinstall spam offline (McAfee, MSOffice, MSOneDrive, Dropbox)</li>
<li>Deinstall built-in applications: login to a desired account, lunch Windows Power Shell,
 run <code>Get-AppxPackage > C:/tmp/new.txt</code> to get list of application names,
 then run <code>Get-AppxPackage *name* | Remove-AppxPackage</code> to delete them</li>
<li>.NET Framework 3.5 (includes 2.0) is required for older apps</li>
</ul>

<h2>Control Panel</h2>
<ul>
<li>About: name the computer</li>
<li>Apps and features: remove garbage</li>
<li>Background: set Desktop background color to (43,85,128)=#2B5580</li>
<li>Date and time: set time zone</li>
<li>Default apps: set your favorite file associations by manually patching Windows Registry, see my code <a href="../../../Sys/Software/win10/FileAssoc/">here</a></li>
<li>Device Manager: check for malfunctioning devices</li>
<li>Desktop Icon Settings: remove everything, but Pin to Start Recycle Bin</li>
<li>Display: native resolution, 125% font size</li>
<li>Indexing Options: check</li>
<li>Language: add Ukrainian language and
 replace default keyboard layout with <a href="ukru.zip">ukru</a> (see <a href="ukru.htm">layout</a>),
 hide language bar (also in "Turn system icons on or off")</li>
<li>Mouse: adjust speed, wheel scrolls 1 line</li>
<li>Power and sleep:
 screen off after 5/15 min, sleep after 15/30 min, hibernate after 30/60 min;
 power button hibernates, closing the lid turns into sleep;
 low/critical battery level 6/2% (by Dell)</li>
<li>Printers and scanners: install printers including print-to-file printers</li>
<li>Region: change system locale to Russian if needed</li>
<li>System Properties:
 disable Remote Assistance;
 Environment Variables: add "C:\Sys" to <code>PATH</code>;
 Visual Effects: Show thumbnails, Show window contents, Smooth edges, Smooth-scroll</li>
<li>Taskbar: lock, auto-hide, use small icons, never combine; disable annoying icons in Notification Area; customize Start Menu (see table below)</li>
<li>Touchpad: disconnect when mouse is connected</li>
<li>Windows Update: automatically check for updates but let me choose whether to download them (not availabe in Windows 10)</li>
</ul>

<h2>Desktop, Taskbar, and Start Menu</h2>
<table border="1" cellspacing="2" cellpadding="2">
<colgroup><col span="6" valign="top"></colgroup>
<tr>
<td>Programs (all users)</td>
<td>Start Menu</td>
<td>Taskbar from Left</td>
<td>Taskbar from Right</td>
<td>Gadgets</td>
<td>Keyboard shortcuts Ctrl+Alt+</td>
</tr>
<tr>
<td>
Science<br>
Office<br>
System<br>
Accessories<br>
Multimedia<br>
Internet</td>
<td>
AVSearch<br>
Mozilla Firefox<br>
Media Player Classic</td>
<td>
Search<br>
Cortana<br>
Microsoft Edge<br>
File Explorer<br>
PSPad</td>
<td>
Show desktop<br>
Time<br>
Network<br>
Battery<br>
Lingvo</td>
<td>
Projects<br>
System<br>
Research<br>
Educational<br>
Science<br>
<a href="http://addgadgets.com/all_cpu_meter/">All CPU Meter</a><br>
<a href="http://addgadgets.com/network_meter/">Network Meter</a></td>
<td>
<strong>B</strong>eyond Compare<br>
<strong>C</strong>artes du Ciel<br>
Corel <strong>D</strong>raw<br>
Internet <strong>E</strong>xplorer<br>
Mozilla <strong>F</strong>irefox<br>
Google c<strong>H</strong>rome<br>
<strong>I</strong>nkscape<br>
Media p<strong>L</strong>ayer<br>
<strong>M</strong>aple<br>
Adobe <strong>P</strong>hotoshop<br>
(<strong>Q</strong>) Resource Monitor<br>
<strong>R</strong>egistry Editor<br>
Win<strong>S</strong>CP<br>
<strong>V</strong>PN client<br>
Microsoft <strong>W</strong>ord<br>
Microsoft e<strong>X</strong>cel</td>
</tr>
</table>

<h2>Maintenance</h2>
<ul>
<li>Create Restore Points on System Protection tab of System Properties</li>
<li>Clean up autorun programs in
 <ul>
 <li><a href="C:/ProgramData/Microsoft/Windows/Start Menu/Programs/Startup">System Startup</a> and
     <a href="../../../AppData/Roaming/Microsoft/Windows/Start Menu/Programs/Startup">User Startup</a></li>
 <li><code>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</code></li>
 <li><code>HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Run</code></li>
 <li>Task Scheduler</li>
 </ul></li>
</ul>

<h2>Battery saving</h2>
<ul>
<li>To investigate performance run <code>powercfg /option /output filename.html</code>, where option is one of batteryreport, energy, sleepstudy.</li>
<li>In case of sleep problems, to disable Connected Standby set <code>HKLM\SYSTEM\CurrentControlSet\Control\Power\CsEnabled</code> to 0.</li>
<li>Common battery drainers:
 <ul>
 <li>Intel SST Audio Device &ndash; update driver, if doesn't help then use <a href="http://auto-mute.com/">Auto Mute</a> utility</li>
 <li>Intel AVStream Camera &ndash; update driver, if doesn't help then don't know</li>
 </ul></li>
</ul>

<h2>Resources saving</h2>
<ul>
<li>Trun off Delivery Optimization in Services and Windows Update</li>
<li>Turn off Microsoft Store in Services</li>
<li>Web Account Manager (TokenBroker) service can be stopped if Windows Update is not needed</li>
</ul>

<h2>Custom system settings</h2>
<ul>
<li>Services switched to Manual start: Cisco AnyConnect, Windows Search, YandexBrowserService</li>
</ul>

<h2>Tips and tricks</h2>
<ul>
<li>Use <a href="https://en.wikipedia.org/wiki/Windows_Subsystem_for_Linux">WSL</a></li>
<li>Windows Desktop Gadgets (Windows Sidebar) is discontinued by Microsoft but can be found <a href="https://gadgetsrevived.com/download-sidebar">here</a></li>
<li>To fix a crazy printer restart Printer Spooler service</li>
<li>Install K-Lite codec pack from <a href="http://www.codecs.com">here</a></li>
<li>To fix blurry text override high DPI scaling in Compatibility, see <a href="https://wpvkp.com/fix-blurry-text-windows-10/">here</a></li>
<li><a href="https://www.windowscentral.com/how-extend-lock-screen-timeout-display-turn-windows-10">Changing lock screen timeout</a></li>
<li>To tune <a href="http://www.virtualplastic.net/html/desk_reg.html">Windows appearance</a>
 backup your current settings by exporting <code>HKCU\Control Panel\Desktop</code>,
 edit <code>WindowsMetrics.reg</code> file and run it</li>
<li>To restart a malfunctioning device by a single click create a batch file with <code>pnputil /disable-device "device instance ID"</code>
 and <code>pnputil /enable-device "device instance ID"</code>, create its shorcut, check "Run as admin" box, and asign a shortcut key.</li>
<li>Changing language for single-language version (<a href="http://stackoverflow.com/questions/31698742/how-to-change-windows-10-interface-language-on-single-language-version">original post</a>):
<ol>
<li>Determine the name of your current language pack: <code>dism /online /get-packages</code>,
 e.g. <code>Microsoft-Windows-Client-LanguagePack-Package~31bf3856ad364e35~x86~ru-RU~10.0.14393.0</code></li>
<li>Download the required language pack, e.g. <code>lp_d17ad4e6831135935760d21e2c8689b667430d0b.cab</code></li>
<li>Install it: <code>dism /online /add-package /packagepath:C:\path_to_cabfile\cabfile.cab</code>
 then <code>dism /online /get-packages</code></li>
<li>Remove the current pack: <code>dism /online /remove-package /packagename:current_pack_name</code></li>
</ol></li>
<li>To block web-parasites update your <a href="C:/Windows/System32/drivers/etc/HOSTS">HOSTS file</a>
 by <a href="https://winhelp2002.mvps.org">MVPS list</a>.
 For efficient browsing stop "DNS Client" service from automatic loading.</li>
</ul>

<h2>Help</h2>
<ul>
<li><a href="https://support.microsoft.com/en-us/windows/keyboard-shortcuts-in-windows-dcc61a57-8ff0-cffe-9796-cb9706c75eec">Windows keyboard shortcuts</a></li>
<li><a href="https://en.wikibooks.org/wiki/Windows_Batch_Scripting">Windows Batch Scripting</a> (Wikibooks)</li>
<li><a href="https://docs.microsoft.com/en-us/windows-server/administration/manage-windows-server">Windows Server Management documentation</a></li>
<li><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/windows-commands">Windows commands</a></li>
<li><a href="https://docs.microsoft.com/en-us/powershell">PowerShell</a></li>
</ul>

</body>
</html>

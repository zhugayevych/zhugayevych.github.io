<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../../soft.css">
<title>Wave-function: Match</title>
</head>
<body>
<h1>Wave-function: Match</h1>

<p>See examples in <code>MatchMO.mw</code></p>

<h2>Procedures</h2>
<ul>
<li><code>MatchOrbitals( A1,ev1,evc1,sym1,S1, A2,ev2,evc2,sym2,S2,
 de,minO:=0,lso:=[],lsi:=[],k2i:=[], {maxrot:=0.1,maxdS:=1e-8,printout})
 ::A2a,ev2a,evc2a,sym2a,C2a,P2a,O12a,O12,S,L,R</code>
 match two sets of orbitals where
 <ul>
 <li><code>sym::{Vector,list}</code> orbital symmetry labels,</li>
 <li><code>O12::Matrix</code> overlap between <code>evc1</code> and <code>evc2</code>,</li>
 <li><code>O12a::Matrix</code> overlap with <code>evc2a</code> containing only matched orbitals,</li>
 <li><code>de::numeric</code> orbitals are matched by symmetry and then by <code>((ev1[o1]-ev2[o2])/de)^2-O12[o1,o2]^2</code>,</li>
 <li><code>minO::numeric</code> discard matched pairs with smaller <code>O12[o1,o2]</code>,</li>
 <li><code>lso::list</code> subset of orbitals to match,</li>
 <li><code>lsi::list</code> subset of atoms used in matching,</li>
 <li><code>k2i::list</code> used to define the common basis <code>|K1|=|K2|</code>, see Notes,</li>
 <li><code>maxrot::numeric</code> </li>
 <li><code>maxdS::numeric</code> if |S1-S2| is larger then S=sqrt(S1)[..,K1].sqrt(S2)[K2,..] otherwise S=S1[K1,K1],</li>
 <li><code>printout::{boolean,posint}:=false</code> number of smallest-overlap orbitals to print (default is 3),</li>
 <li><code>A2a::Atoms</code> superimposed <code>A2</code>,</li>
 <li><code>R::Matrix</code> rotation matrix <code>A2</code> to <code>A1</code>,</li>
 <li><code>ev2a,evc2a,sym2a</code> new orbitals, see Notes,</li>
 <li><code>P2a::list</code> permutation of orbitals,</li>
 <li><code>C2a::Vector</code> such that <code>C2a[o]=O12a[o,o]</code> for matched orbitals, 7 for unmatched evc1, 8 for unmatched evc2, 9 otherwise,</li>
 <li><code>L::list([O12a[o,o],ev2[o2]-ev1[o1],o1,ev1[o1],o2,ev2[o2]])</code>, note that <code>O12a</code> is reduced to subset of matched and permuted orbitals.</li>
 </ul>
 Notes:
 <ul>
 <li>In the current implementation orbitals are not rotated.</li>
 <li>Each of parameters <code>lso,lsi,k2i</code> can be a single list or a pair of lists.
  In the former case the list is duplicated.</li>
 <li>For each molecule, its list <code>k2i</code> can be either unfolded basis set or list of atom indexes
  &ndash; only basis functions belonging to <code>lsi</code> will be kept and reordered according to <code>lsi</code>.</li>
 <li>In <code>ev2a,evc2a</code> matched orbitals are reordered and sign-corrected,
  unmatched <code>evc1</code> orbitals are replaced with <code>evc1</code> orbitals,
  unmatched <code>evc2</code> orbitals are moved right after the last matched orbital,
  and the rest of <code>evc2</code> orbitals are shifted appropriately.</li>
 </ul></li>
</ul>

</body>
</html>
